#!/bin/bash

. ${HOME}/etc/shell.conf
. ${SHINCLUDE}/lg-functions

while [ $# -gt 0 ]; do
    case $1 in
        --hosts|-h)
            shift
            LG_FRAMES="$1"
          ;;
    esac 
    shift   
done
RSS_LIMIT=${1:-100000}
ME=`basename $0`

lg-sudo-bg --hosts "${LG_FRAMES}" "
for instance in \`ps -o vsz=,user= \$(pgrep googleearth-bin) | sed -e 's/^\s*//g' -e 's/ /:/g'\`; do
    if [ \${instance%%:*} -lt ${RSS_LIMIT} ]; then
        logger -p local3.info \"$ME killing \${instance##*:} \${instance%%:*}\"
        pkill -u \${instance##*:} googleearth-bin
    fi
done
"
